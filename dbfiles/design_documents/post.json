{
  "_id": "_design/post",
  ,
  "views": {
    "posts": {
      "map": "t=>'post'===t.type&&emit(t._id,t);"
    },
    "by_date": {
      "map": "t=>'post'===t.type&&emit(t.publication_date,{title:t.title,username:t.username});"
    },
    "by_theme": {
      "map": "t=>{'post'===t.type&&emit(t.theme,{_id:t._id,title:t.title,publication_date:t.publication_date,username:t.username})};",
      "reduce": "(k,v,r)=>v.flat();"
    }
  },
  "updates": {
    "updateComments": "function(doc,req) { if (doc['type'] === 'post') { doc['comments'].push(JSON.parse(req.body)); return [doc, 'Post updated'];}return [null, 'Nothing updated']; }"
  },
  "language": "javascript"
}